#based on: https://gist.githubusercontent.com/nicolonsky/fdfdf78a4db6f4ce5cf321ad208f339d/raw/359759f016a1673a352d921d536d1fd7e26491d0/AutoMountTeamSites.ps1
# ad Name of Site and ID at Line 12

#run in usercotext


$tenantAutoMountRegKey="HKLM:\SOFTWARE\Policies\Microsoft\OneDrive\TenantAutoMount"

$autoMountTeamSitesList= @{
    
    #Enter yyour SharePoint libraries to configure here as key/value pairs
    DemoTeamSite="Enter your encoded SharePoint library ID here"
}


if (-not (Test-Path $tenantAutoMountRegKey)){
    
    New-Item -Path $tenantAutoMountRegKey -Force

}


#add registry entries from the hashtable above
$autoMountTeamSitesList.GetEnumerator() | ForEach-Object {
        
    Set-ItemProperty -Path $tenantAutoMountRegKey -Name $PSItem.Key -Value $PSItem.Value -ErrorAction Stop
}
